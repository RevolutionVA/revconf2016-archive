function onDocLoaded(e,t){var n=setInterval(function(){"complete"===document.readyState&&(clearInterval(n),e(t))},100)}function googleAuthInit(e){var t,n=this;n.User;var o=function(){};return gapi.load("auth2",function(){t=gapi.auth2.init({client_id:"865035679015-c7n7s2oq7j0tn3kh7m8hihl86p0kj0qr.apps.googleusercontent.com",scope:"email"}),n.userChanged=function(e){"function"==typeof e&&(o=e)},n.signOut=function(){t.disconnect()},n.signIn=function(){t.signIn()},t.isSignedIn.listen(function(e){}),t.currentUser.listen(function(e){n.User=e,o()}),1==t.isSignedIn.get()&&t.signIn(),t&&(n.User=t.currentUser.get(),o()),"function"==typeof e&&e()}),n}function SortByTitle(e,t){return e=e.title.toLowerCase(),t=t.title.toLowerCase(),e<t?-1:e>t?1:0}!function(){"use strict";if(navigator.userAgent.match(/IEMobile\/10\.0/)){var e=document.createElement("style");e.appendChild(document.createTextNode("@-ms-viewport{width:auto!important}")),document.head.appendChild(e)}}();var RevConfModule=angular.module("RevConfModule",["ui.router","ngSanitize"]);!function(e){RevConfModule.run(["$rootScope","$state","wpApiService","$timeout","$location",function(t,n,o,r,i){t.state=n,window.$rootScope=t,t.loaded=!1;var s=null;o.init().then(function(){t.loaded=!0,onDocLoaded(function(){e("body").removeClass("loading")}),s=s||{toStateName:"home",toParams:{}},n.go(s.toStateName,s.toParams)}),t.$on("$stateChangeStart",function(o,r,i,a,u,l){"loading"===r.name||t.loaded||(o.preventDefault(),s={toStateName:r.name,toParams:i,hash:window.location.hash},n.go("loading")),e("[data-section-id]").removeClass("active")}),t.$on("$stateChangeSuccess",function(e,t,n,o,r,a){"loading"!==t.name&&s&&(s.hash&&i.hash(s.hash.substring(1)),s=null)})}]).config(["$locationProvider","$stateProvider","$urlRouterProvider","$httpProvider",function(e,t,n,o){o.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded;charset=utf-8",e.html5Mode(!0),n.when("","/home"),n.otherwise("/home"),t.state("loading",{url:"/loading",title:"loading",views:{"main@":{template:""}}}).state("about",{url:"/about",title:"About",views:{"main@":{templateUrl:"/templates/about.html",controllerAs:"vm",controller:"aboutController"}}}).state("schedule",{url:"/schedule",title:"Schedule",views:{"main@":{templateUrl:"/templates/schedule.html",controllerAs:"vm",controller:"scheduleController"}}}).state("home",{url:"/home",title:"Home",params:{section:"intro"},views:{"main@":{templateUrl:"/templates/home.html",controllerAs:"vm",controller:"homeController"}}}).state("default",{url:"/{path:.+}",title:"loading",views:{"main@":{controllerAs:"vm",controller:"defaultController",templateUrl:"/templates/default.html"}}})}]).directive("outboundTrack",function(){return{restrict:"A",link:function(e,t){t.on("click",function(){event.preventDefault();var e=this.href;ga("send","event","outbound","click",e,{transport:"beacon"}),window.open(e)})}}}).directive("contributor",function(){return{restrict:"E",templateUrl:"/templates/contributor.html"}}).directive("contributorDetails",["wpApiService","$rootScope","$timeout",function(t,n,o){return e("#contributor-modal").on("hidden.bs.modal",function(e){o(function(){n.contributor=!1})}),{restrict:"A",link:function(r,i,s){i.on("click","a",function(e){e.stopPropagation()}),i.on("click",function(r){var i=parseInt(s.contributorDetails);o(function(){n.contributor=t.getContributor(i)}),e("#contributor-modal").modal({show:!0})})}}}]).directive("sponsor",["wpApiService","$rootScope","$timeout",function(e,t,n){return{restrict:"E",templateUrl:"templates/sponsor.html",link:function(e,t){}}}]),e(document).on("click","a[data-no-bubble]",function(e){e.stopPropagation()}).on("click","[data-section-id] a",function(t){e(".navbar-toggler:visible").trigger("click")})}(jQuery);var shuffleArray=function(e){for(var t,n,o=e.length;o;)n=Math.floor(Math.random()*o--),t=e[o],e[o]=e[n],e[n]=t;return e};!function(e){RevConfModule.controller("aboutController",["$rootScope","$scope","wpApiService",function(e,t,n){var o=this;e.title="RevolutionConf 2016",o.Organizers=n.getOrganizers(),o.Advisors=shuffleArray(n.getAdvisors()),o.Volunteers=shuffleArray(n.getVolunteers()),o.Content=n.getContent()}])}(jQuery),function(e){RevConfModule.controller("defaultController",["$rootScope","$scope","wpApiService","$location",function(e,t,n,o){var r=this;r.page=n.getPage(o.path().split("/")[1])||{title:"404 - Page not Found",content:"<p>Page not found, sorry.</p>"},e.title=r.page.title}])}(jQuery),RevConfModule.controller("homeController",["$rootScope","$scope","wpApiService",function(e,t,n){var o=this;e.title="RevolutionConf 2016",o.Tickets=n.getTickets(),o.Organizers=n.getOrganizers(),o.Speakers=shuffleArray(n.getSpeakers()),o.KeynoteSpeaker=n.getKeynoteSpeaker(),o.Sessions=n.getSessions(),o.Sessions.sort(SortByTitle),o.Content=n.getContent(),o.Sponsors=n.getSponsors(),onDocLoaded(function(){function e(){clearTimeout(s),s=setTimeout(n,100)}function n(){var e=$("body").scrollTop();$(r).each(function(t,n){var r=n.position.offset().top;if(e>=r&&e<=r+n.container.height())return i!=n.id&&(o.removeClass("active"),n.link.addClass("active")),i=n.id,!1})}var o=$("[data-section-id]"),r=[],i="",s=null;o.each(function(){var e=$(this),t=e.data("section-id");r.push({id:t,link:e,position:$("#"+t),container:$("#"+t).parent()})}),window.location.hash&&$(r).each(function(e,t){if(window.location.hash==="#"+t.id)return $("html, body").scrollTop(t.position.offset().top),!1}),$(document).on("scroll",e),t.$on("$destroy",function(){$(document).off("scroll",e)}),n()})}]).directive("signUpForm",function(){return{restrict:"A",link:function(e,t){function n(e){var t=/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return t.test(e)}var o=!1;$(t).on("submit",function(e){var r=$('[name="fullname"]',t),i=$('[name="email"]',t);return e.preventDefault(),!!o||($(".has-danger",t).removeClass("has-danger"),r.val().length||r.closest(".form-group").addClass("has-danger"),i.val().length&&n(i.val())||i.closest(".form-group").addClass("has-danger"),$(".has-danger",t).length||(o=!0,$(".form-group",t).hide(),$(".text-success",t).show(),setTimeout(function(){},1e3)),!!o&&void 0)})}}}),function(e){RevConfModule.controller("scheduleController",["$rootScope","$scope","wpApiService","$timeout",function(t,n,o,r){var i=this;i.Favorites={},t.title="RevolutionConf 2016",i.GoogleAuth=new googleAuthInit(function(){var e=function(){r(function(){i.GoogleAuth.User.isSignedIn()?(i.Save.Server=!0,i.Save.User={id_token:i.GoogleAuth.User.getAuthResponse().id_token,email:i.GoogleAuth.User.getBasicProfile().getEmail()},i.Save.pullFromServer(function(){i.Save.pushToServer()})):i.Save.Server=!1},1)};i.GoogleAuth.userChanged(e),e()}),i.Save={User:{id_token:null,email:null},Server:!1,Active:!1,methodSwitch:function(){i.Save.Active||(i.Save.Server?i.GoogleAuth.signOut():i.GoogleAuth.signIn())},Timeout:null,pushToServer:function(e){e="function"==typeof e?e:function(){},i.Save.Server&&(i.Save.Timeout&&r.cancel(i.Save.Timeout),i.Save.Timeout=r(function(){i.Save.Active=!0,o.saveUserSchedule({id_token:i.Save.User.id_token,filter:i.filter,favoriteItems:i.favoriteItems}).then(function(){e(),i.Save.Active=!1})},2e3))},pullFromServer:function(e){e="function"==typeof e?e:function(){},o.getUserSchedule({id_token:i.Save.User.id_token}).then(function(t){r(function(){t&&t.filter&&(i.filter=t.filter),t&&t.favoriteItems&&(i.favoriteItems=t.favoriteItems),e()},1)})}},i.filter=localStorage.getItem("schedule-filter")?JSON.parse(localStorage.getItem("schedule-filter")):{favs:!1,room:"",search:""},i.filterUpdated=function(){localStorage.setItem("schedule-filter",JSON.stringify(i.filter)),i.Save.pushToServer()},i.favoriteItems=localStorage.getItem("schedule-favorites")?JSON.parse(localStorage.getItem("schedule-favorites")):{},i.favoriteItemsUpdated=function(e){localStorage.setItem("schedule-favorites",JSON.stringify(i.favoriteItems)),i.Save.pushToServer()},i.filterEvents=function(e){var t=!1;return t||!i.filter.favs||i.favoriteItems[e.ID]||(t=!0),!t&&i.filter.room&&e.room!==i.filter.room&&(t=!0),!t&&i.filter.search&&(t=e.searchBlob.indexOf(i.filter.search.toLowerCase())===-1),!t},i.Schedule=o.getSchedule(),i.Schedule=e.map(i.Schedule,function(t){return t.eventIds=e.map(t.items,function(e){return e.ID}),t.items=e.map(t.items,function(t){return t.searchBlob=t.speaker?e(["<div>",t.title,t.description,t.speaker.name,t.speaker.title,t.speaker.company_name,"</div>"].join(" ")).text().toLowerCase():"",t}),t.eventIds=t.eventIds.length>1&&t.eventIds,t}),i.timeslotHasFavs=function(e){return!!e.eventIds&&e.eventIds.filter(function(e){return i.Favorites[e]}).length},i.favSession=function(t,n){e.each(n,function(e,n){t!=n&&delete i.Favorites[n]}),i.Favorites[t]=!i.Favorites[t]},i.Speakers=shuffleArray(o.getSpeakers())}])}(jQuery),function(){RevConfModule.service("wpApiService",["$http","$q","$sce","$rootScope",function(e,t,n,o){function r(e,t){var n=a[t].ids.indexOf(e);return a[t].items[n]}function i(e){return $.extend(e,{sessions:$.grep(a.sessions.items,function(t){return t.speaker==e.ID})})}function s(e){return $.extend(e,{speaker:r(e.speaker,"contributors")})}var a={sponsors:{items:[],ids:[]},sponsor_levels:{items:[],ids:[]},tickets:{items:[],ids:[]},sessions:{items:[],ids:[]},general:{content:{}},contributors:{items:[],ids:[]},schedule:[]},u="/api";return o.appInitiated=!1,{getContributor:function(e){return r(e,"contributors")},getContent:function(){return a.content},getPage:function(e){var t=$.grep(a.pages,function(t){return t.slug===e});return t.length?t[0]:null},getSpeakers:function(){var e=$.grep(a.contributors.items,function(e){return"Speaker"===e.role});return e=$.map(e,function(e){return new i(e)})},getKeynoteSpeaker:function(){return $.grep(a.contributors.items,function(e){return"Keynote Speaker"===e.role})[0]},getAdvisors:function(){return $.grep(a.contributors.items,function(e){return"Advisor"===e.role})},getVolunteers:function(){return $.grep(a.contributors.items,function(e){return"Volunteer"===e.role})},getOrganizers:function(){return $.grep(a.contributors.items,function(e){return"Organizer"===e.role})},getSessions:function(){return $.map(a.sessions.items,function(e){return new s(e)})},getSessionsBySpeaker:function(e){return $.grep(a.sessions.items,function(t){return t.speaker==e})},getSponsors:function(){return a.sponsors.items},getTickets:function(){return $.map(a.tickets.items,function(e){return e.available="available"===e.availability,e})},getSchedule:function(){return $.map(a.schedule,function(e){return e.items=$.map(e.items,function(e){return e.speaker&&(e=new s(e)),e}),e})},init:function(){return t.all([e.get(u+"/sponsors.json"),e.get(u+"/sponsor-levels.json"),e.get(u+"/tickets.json"),e.get(u+"/sessions.json"),e.get(u+"/general.json"),e.get(u+"/contributors.json"),e.get(u+"/schedule.json")]).then(function(e){a.sponsors=e[0].data,a.sponsor_levels=e[1].data,a.tickets=e[2].data,a.sessions=e[3].data,a.content=e[4].data.data.content,a.pages=e[4].data.data.pages,a.contributors=e[5].data,a.schedule=e[6].data.data})},saveUserSchedule:function(e){},getUserSchedule:function(e){}}}])}();